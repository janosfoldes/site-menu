{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/js/site-menu.js"],"names":[],"mappings":"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","file":"../js/site-menu.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","// SITE-MENU\r\n// =========\r\n\r\nconst attrAriaExpanded    = 'aria-expanded';\r\nconst attrMultiExpand     = 'data-multi-expand';\r\nconst attrSiteMenu        = 'data-site-menu';\r\nconst attrSiteMenuButton  = 'data-site-menu-button';\r\nconst attrSiteMenuLock    = 'data-site-menu-lock'\r\nconst attrSubmenuAppendTo = 'data-submenu-append-to';\r\nconst elSubmenuIcon       =  '<i class=\"submenu-icon\"></i>';\r\nconst togglerCollapsed    = 'is-collapsed';\r\nconst togglerExpanded     = 'is-expanded';\r\nconst togglerLocked       = 'is-locked';\r\nconst togglerNoAnim       = 'no-anim';\r\n\r\n// Menu\r\n// ----\r\n\r\nexport default class SiteMenu {\r\n    constructor(element) {\r\n        /* Initialize */\r\n        this._menu = $(element);\r\n        this._button = $('#' + this._menu.attr(attrSiteMenuButton));\r\n        this._multiExpand = (this._menu.attr(attrMultiExpand) == 'true');\r\n        this._submenuAppendTo = $('#' + this._menu.attr(attrSubmenuAppendTo));\r\n\r\n        /* Submenus */\r\n        this._submenus = [];\r\n        let submenus = this._menu.find('li>ul');\r\n        for (let i=0; i < submenus.length; i++) {\r\n            this._submenus.push(\r\n                new SubMenu(submenus[i], this, i)\r\n            );\r\n        }\r\n\r\n        /* Locks */\r\n        this._locks = []\r\n        let lockIds = SiteMenu.stringToArray(this._menu.attr(attrSiteMenuLock));\r\n        for (let i = 0; i < lockIds.length; i++) {\r\n            this._locks.push($('#' + lockIds[i]));\r\n        }\r\n\r\n        /* Refresh */\r\n        this.refresh();\r\n\r\n        /* Events */\r\n        $(window).resize((e) => { this.onResize(e) });\r\n    }\r\n\r\n    lockTargets(state) {\r\n        for (let i = 0; i < this._locks.length; i++) {\r\n            this._locks[i].toggleClass(togglerLocked, state)\r\n        }\r\n    }\r\n\r\n    onResize(e) {\r\n        this.refresh();\r\n    }\r\n\r\n    refresh() {\r\n        let isRevealed = !this._button.is(':visible');\r\n        if (isRevealed != this._isRevealed) { // State changed\r\n            this._isRevealed = isRevealed;\r\n            for (let i=0; i < this._submenus.length; i++) {\r\n                if (isRevealed) {\r\n                    this._submenus[i].moveTo(this._submenuAppendTo);\r\n                    this._submenus[i].resetMaxHeight(false);\r\n                } else {\r\n                    this._submenus[i].moveHome();\r\n                    this._submenus[i].setMaxHeight(false);\r\n                }\r\n                this._submenus[i].toggle(false, false);\r\n            }\r\n        }\r\n    }\r\n\r\n    static stringToArray(str) {\r\n        let a = [];\r\n        if (typeof str === 'string') {\r\n            str = str.trim();\r\n            if (str != '') {\r\n                a = (str.indexOf(',') > -1) ? str.split(/,/) : str.split(/ /);\r\n                for (let i=0; i < a.lenght; i++) a[i] = a[i].trim();\r\n            }\r\n        }\r\n        return a;\r\n    }\r\n\r\n    toggleSubmenus(state, animation = true, expectIndex) {\r\n        for (let i=0; i < this._submenus.length; i++) {\r\n            if (i != expectIndex) this._submenus[i].toggle(state, animation);\r\n        }\r\n    }\r\n}\r\n\r\n// SubMenu\r\n// -------\r\n\r\nclass SubMenu {\r\n    constructor(element, menu, index) {\r\n        this._index = index;\r\n        this._menu = menu;\r\n        this._submenu = $(element);\r\n        this._expanded = (this._submenu.outerHeight() > 0);\r\n        this._button = this._submenu.prev();\r\n        this._submenuIcon = $(elSubmenuIcon);\r\n        this._submenuIcon.appendTo(this._button);\r\n\r\n        this.toggle(this._expanded);\r\n\r\n        this._button.on('click', (e) => { this.onClick(e) });\r\n        this._button.on('mouseenter', (e) => { this.onMouseEnter(e) });\r\n        this._button.on('mouseleave', (e) => { this.onMouseLeave(e) });\r\n        this._submenu.on('mouseenter', (e) => { this.onMouseEnter(e) });\r\n        this._submenu.on('mouseleave', (e) => { this.onMouseLeave(e) });\r\n    }\r\n\r\n    moveHome() {\r\n        this._submenu.insertAfter(this._button);\r\n    }\r\n\r\n    moveTo(element) {\r\n        this._submenu.appendTo(element);\r\n    }\r\n\r\n    onClick(e) {\r\n        e.preventDefault();\r\n        if (this._menu._isRevealed) return;\r\n        if (!this._menu._multiExpand) this._menu.toggleSubmenus(false, true, this._index);\r\n        this.toggle();\r\n    }\r\n\r\n    onMouseEnter(e) {\r\n        if (this._menu._isRevealed) {\r\n            this._menu.lockTargets(true);\r\n            this.toggle(true);\r\n        }\r\n    }\r\n\r\n    onMouseLeave(e) {\r\n        if (this._menu._isRevealed) {\r\n            this._menu.lockTargets(false);\r\n            this.toggle(false);\r\n        }\r\n    }\r\n\r\n    resetMaxHeight() {\r\n        this._submenu.css('max-height', '');\r\n    }\r\n\r\n    setMaxHeight(state) {\r\n        this._submenu.css('max-height', (state) ? this._submenu[0].scrollHeight : 0);\r\n    }\r\n\r\n    toggle(state, animation = true) {\r\n        this._submenu.toggleClass(togglerNoAnim, !animation);\r\n        if (state == undefined) state = !this._expanded;\r\n        // console.log('submenu', this._index, state, this._expanded, (state != this._expanded) ? 'state changed' : '');\r\n        if (state != this._expanded) {\r\n            this._button.toggleClass(togglerExpanded, state);\r\n            if (!this._menu._isRevealed) this.setMaxHeight(state);\r\n            this._submenu.attr(attrAriaExpanded, state);\r\n            this._submenu.toggleClass(togglerCollapsed, !state);\r\n            this._submenu.toggleClass(togglerExpanded, state);\r\n            this._expanded = state;\r\n        }\r\n    }\r\n}\r\n\r\n// Initialize elements with 'data-site-menu' attribute\r\n// ---------------------------------------------------\r\n\r\nlet siteMenus = [];\r\n$(document).ready(() => {\r\n    $('[' + attrSiteMenu + ']').each((index, item) => {\r\n        siteMenus.push(new SiteMenu(item));\r\n    });\r\n});"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvanMvc2l0ZS1tZW51LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Ozs7Ozs7OztBQ0FBO0FBQ0E7QUFFQSxJQUFNLGdCQUFnQixHQUFNLGVBQTVCO0FBQ0EsSUFBTSxlQUFlLEdBQU8sbUJBQTVCO0FBQ0EsSUFBTSxZQUFZLEdBQVUsZ0JBQTVCO0FBQ0EsSUFBTSxrQkFBa0IsR0FBSSx1QkFBNUI7QUFDQSxJQUFNLGdCQUFnQixHQUFNLHFCQUE1QjtBQUNBLElBQU0sbUJBQW1CLEdBQUcsd0JBQTVCO0FBQ0EsSUFBTSxhQUFhLEdBQVUsOEJBQTdCO0FBQ0EsSUFBTSxnQkFBZ0IsR0FBTSxjQUE1QjtBQUNBLElBQU0sZUFBZSxHQUFPLGFBQTVCO0FBQ0EsSUFBTSxhQUFhLEdBQVMsV0FBNUI7QUFDQSxJQUFNLGFBQWEsR0FBUyxTQUE1QixDLENBRUE7QUFDQTs7SUFFcUIsUTs7O0FBQ2pCLG9CQUFZLE9BQVosRUFBcUI7QUFBQTs7QUFBQTs7QUFDakI7QUFDQSxTQUFLLEtBQUwsR0FBYSxDQUFDLENBQUMsT0FBRCxDQUFkO0FBQ0EsU0FBSyxPQUFMLEdBQWUsQ0FBQyxDQUFDLE1BQU0sS0FBSyxLQUFMLENBQVcsSUFBWCxDQUFnQixrQkFBaEIsQ0FBUCxDQUFoQjtBQUNBLFNBQUssWUFBTCxHQUFxQixLQUFLLEtBQUwsQ0FBVyxJQUFYLENBQWdCLGVBQWhCLEtBQW9DLE1BQXpEO0FBQ0EsU0FBSyxnQkFBTCxHQUF3QixDQUFDLENBQUMsTUFBTSxLQUFLLEtBQUwsQ0FBVyxJQUFYLENBQWdCLG1CQUFoQixDQUFQLENBQXpCO0FBRUE7O0FBQ0EsU0FBSyxTQUFMLEdBQWlCLEVBQWpCOztBQUNBLFFBQUksUUFBUSxHQUFHLEtBQUssS0FBTCxDQUFXLElBQVgsQ0FBZ0IsT0FBaEIsQ0FBZjs7QUFDQSxTQUFLLElBQUksQ0FBQyxHQUFDLENBQVgsRUFBYyxDQUFD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SCxDQUpEIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXtmdW5jdGlvbiByKGUsbix0KXtmdW5jdGlvbiBvKGksZil7aWYoIW5baV0pe2lmKCFlW2ldKXt2YXIgYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFmJiZjKXJldHVybiBjKGksITApO2lmKHUpcmV0dXJuIHUoaSwhMCk7dmFyIGE9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitpK1wiJ1wiKTt0aHJvdyBhLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsYX12YXIgcD1uW2ldPXtleHBvcnRzOnt9fTtlW2ldWzBdLmNhbGwocC5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciBuPWVbaV1bMV1bcl07cmV0dXJuIG8obnx8cil9LHAscC5leHBvcnRzLHIsZSxuLHQpfXJldHVybiBuW2ldLmV4cG9ydHN9Zm9yKHZhciB1PVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpIiwiLy8gU0lURS1NRU5VXHJcbi8vID09PT09PT09PVxyXG5cclxuY29uc3QgYXR0ckFyaWFFeHBhbmRlZCAgICA9ICdhcmlhLWV4cGFuZGVkJztcclxuY29uc3QgYXR0ck11bHRpRXhwYW5kICAgICA9ICdkYXRhLW11bHRpLWV4cGFuZCc7XHJcbmNvbnN0IGF0dHJTaXRlTWVudSAgICAgICAgPSAnZGF0YS1zaXRlLW1lbnUnO1xyXG5jb25zdCBhdHRyU2l0ZU1lbnVCdXR0b24gID0gJ2RhdGEtc2l0ZS1tZW51LWJ1dHRvbic7XHJcbmNvbnN0IGF0dHJTaXRlTWVudUxvY2sgICAgPSAnZGF0YS1zaXRlLW1lbnUtbG9jaydcclxuY29uc3QgYXR0clN1Ym1lbnVBcHBlbmRUbyA9ICdkYXRhLXN1Ym1lbnUtYXBwZW5kLXRvJztcclxuY29uc3QgZWxTdWJtZW51SWNvbiAgICAgICA9ICAnPGkgY2xhc3M9XCJzdWJtZW51LWljb25cIj48L2k+JztcclxuY29uc3QgdG9nZ2xlckNvbGxhcHNlZCAgICA9ICdpcy1jb2xsYXBzZWQnO1xyXG5jb25zdCB0b2dnbGVyRXhwYW5kZWQgICAgID0gJ2lzLWV4cGFuZGVkJztcclxuY29uc3QgdG9nZ2xlckxvY2tlZCAgICAgICA9ICdpcy1sb2NrZWQnO1xyXG5jb25zdCB0b2dnbGVyTm9BbmltICAgICAgID0gJ25vLWFuaW0nO1xyXG5cclxuLy8gTWVudVxyXG4vLyAtLS0tXHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTaXRlTWVudSB7XHJcbiAgICBjb25zdHJ1Y3RvcihlbGVtZW50KSB7XHJcbiAgICAgICAgLyogSW5pdGlhbGl6ZSAqL1xyXG4gICAgICAgIHRoaXMuX21lbnUgPSAkKGVsZW1lbnQpO1xyXG4gICAgICAgIHRoaXMuX2J1dHRvbiA9ICQoJyMnICsgdGhpcy5fbWVudS5hdHRyKGF0dHJTaXRlTWVudUJ1dHRvbikpO1xyXG4gICAgICAgIHRoaXMuX211bHRpRXhwYW5kID0gKHRoaXMuX21lbnUuYXR0cihhdHRyTXVsdGlFeHBhbmQpID09ICd0cnVlJyk7XHJcbiAgICAgICAgdGhpcy5fc3VibWVudUFwcGVuZFRvID0gJCgnIycgKyB0aGlzLl9tZW51LmF0dHIoYXR0clN1Ym1lbnVBcHBlbmRUbykpO1xyXG5cclxuICAgICAgICAvKiBTdWJtZW51cyAqL1xyXG4gICAgICAgIHRoaXMuX3N1Ym1lbnVzID0gW107XHJcbiAgICAgICAgbGV0IHN1Ym1lbnVzID0gdGhpcy5fbWVudS5maW5kKCdsaT51bCcpO1xyXG4gICAgICAgIGZvciAobGV0IGk9MDsgaSA8IHN1Ym1lbnVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3N1Ym1lbnVzLnB1c2goXHJcbiAgICAgICAgICAgICAgICBuZXcgU3ViTWVudShzdWJtZW51c1tpXSwgdGhpcywgaSlcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qIExvY2tzICovXHJcbiAgICAgICAgdGhpcy5fbG9ja3MgPSBbXVxyXG4gICAgICAgIGxldCBsb2NrSWRzID0gU2l0ZU1lbnUuc3RyaW5nVG9BcnJheSh0aGlzLl9tZW51LmF0dHIoYXR0clNpdGVNZW51TG9jaykpO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbG9ja0lkcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB0aGlzLl9sb2Nrcy5wdXNoKCQoJyMnICsgbG9ja0lkc1tpXSkpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyogUmVmcmVzaCAqL1xyXG4gICAgICAgIHRoaXMucmVmcmVzaCgpO1xyXG5cclxuICAgICAgICAvKiBFdmVudHMgKi9cclxuICAgICAgICAkKHdpbmRvdykucmVzaXplKChlKSA9PiB7IHRoaXMub25SZXNpemUoZSkgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgbG9ja1RhcmdldHMoc3RhdGUpIHtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuX2xvY2tzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2xvY2tzW2ldLnRvZ2dsZUNsYXNzKHRvZ2dsZXJMb2NrZWQsIHN0YXRlKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBvblJlc2l6ZShlKSB7XHJcbiAgICAgICAgdGhpcy5yZWZyZXNoKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVmcmVzaCgpIHtcclxuICAgICAgICBsZXQgaXNSZXZlYWxlZCA9ICF0aGlzLl9idXR0b24uaXMoJzp2aXNpYmxlJyk7XHJcbiAgICAgICAgaWYgKGlzUmV2ZWFsZWQgIT0gdGhpcy5faXNSZXZlYWxlZCkgeyAvLyBTdGF0ZSBjaGFuZ2VkXHJcbiAgICAgICAgICAgIHRoaXMuX2lzUmV2ZWFsZWQgPSBpc1JldmVhbGVkO1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpPTA7IGkgPCB0aGlzLl9zdWJtZW51cy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGlzUmV2ZWFsZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdWJtZW51c1tpXS5tb3ZlVG8odGhpcy5fc3VibWVudUFwcGVuZFRvKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdWJtZW51c1tpXS5yZXNldE1heEhlaWdodChmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3N1Ym1lbnVzW2ldLm1vdmVIb21lKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3VibWVudXNbaV0uc2V0TWF4SGVpZ2h0KGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuX3N1Ym1lbnVzW2ldLnRvZ2dsZShmYWxzZSwgZmFsc2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyBzdHJpbmdUb0FycmF5KHN0cikge1xyXG4gICAgICAgIGxldCBhID0gW107XHJcbiAgICAgICAgaWYgKHR5cGVvZiBzdHIgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgIHN0ciA9IHN0ci50cmltKCk7XHJcbiAgICAgICAgICAgIGlmIChzdHIgIT0gJycpIHtcclxuICAgICAgICAgICAgICAgIGEgPSAoc3RyLmluZGV4T2YoJywnKSA+IC0xKSA/IHN0ci5zcGxpdCgvLC8pIDogc3RyLnNwbGl0KC8gLyk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpPTA7IGkgPCBhLmxlbmdodDsgaSsrKSBhW2ldID0gYVtpXS50cmltKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGE7XHJcbiAgICB9XHJcblxyXG4gICAgdG9nZ2xlU3VibWVudXMoc3RhdGUsIGFuaW1hdGlvbiA9IHRydWUsIGV4cGVjdEluZGV4KSB7XHJcbiAgICAgICAgZm9yIChsZXQgaT0wOyBpIDwgdGhpcy5fc3VibWVudXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKGkgIT0gZXhwZWN0SW5kZXgpIHRoaXMuX3N1Ym1lbnVzW2ldLnRvZ2dsZShzdGF0ZSwgYW5pbWF0aW9uKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIFN1Yk1lbnVcclxuLy8gLS0tLS0tLVxyXG5cclxuY2xhc3MgU3ViTWVudSB7XHJcbiAgICBjb25zdHJ1Y3RvcihlbGVtZW50LCBtZW51LCBpbmRleCkge1xyXG4gICAgICAgIHRoaXMuX2luZGV4ID0gaW5kZXg7XHJcbiAgICAgICAgdGhpcy5fbWVudSA9IG1lbnU7XHJcbiAgICAgICAgdGhpcy5fc3VibWVudSA9ICQoZWxlbWVudCk7XHJcbiAgICAgICAgdGhpcy5fZXhwYW5kZWQgPSAodGhpcy5fc3VibWVudS5vdXRlckhlaWdodCgpID4gMCk7XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uID0gdGhpcy5fc3VibWVudS5wcmV2KCk7XHJcbiAgICAgICAgdGhpcy5fc3VibWVudUljb24gPSAkKGVsU3VibWVudUljb24pO1xyXG4gICAgICAgIHRoaXMuX3N1Ym1lbnVJY29uLmFwcGVuZFRvKHRoaXMuX2J1dHRvbik7XHJcblxyXG4gICAgICAgIHRoaXMudG9nZ2xlKHRoaXMuX2V4cGFuZGVkKTtcclxuXHJcbiAgICAgICAgdGhpcy5fYnV0dG9uLm9uKCdjbGljaycsIChlKSA9PiB7IHRoaXMub25DbGljayhlKSB9KTtcclxuICAgICAgICB0aGlzLl9idXR0b24ub24oJ21vdXNlZW50ZXInLCAoZSkgPT4geyB0aGlzLm9uTW91c2VFbnRlcihlKSB9KTtcclxuICAgICAgICB0aGlzLl9idXR0b24ub24oJ21vdXNlbGVhdmUnLCAoZSkgPT4geyB0aGlzLm9uTW91c2VMZWF2ZShlKSB9KTtcclxuICAgICAgICB0aGlzLl9zdWJtZW51Lm9uKCdtb3VzZWVudGVyJywgKGUpID0+IHsgdGhpcy5vbk1vdXNlRW50ZXIoZSkgfSk7XHJcbiAgICAgICAgdGhpcy5fc3VibWVudS5vbignbW91c2VsZWF2ZScsIChlKSA9PiB7IHRoaXMub25Nb3VzZUxlYXZlKGUpIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIG1vdmVIb21lKCkge1xyXG4gICAgICAgIHRoaXMuX3N1Ym1lbnUuaW5zZXJ0QWZ0ZXIodGhpcy5fYnV0dG9uKTtcclxuICAgIH1cclxuXHJcbiAgICBtb3ZlVG8oZWxlbWVudCkge1xyXG4gICAgICAgIHRoaXMuX3N1Ym1lbnUuYXBwZW5kVG8oZWxlbWVudCk7XHJcbiAgICB9XHJcblxyXG4gICAgb25DbGljayhlKSB7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIGlmICh0aGlzLl9tZW51Ll9pc1JldmVhbGVkKSByZXR1cm47XHJcbiAgICAgICAgaWYgKCF0aGlzLl9tZW51Ll9tdWx0aUV4cGFuZCkgdGhpcy5fbWVudS50b2dnbGVTdWJtZW51cyhmYWxzZSwgdHJ1ZSwgdGhpcy5faW5kZXgpO1xyXG4gICAgICAgIHRoaXMudG9nZ2xlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgb25Nb3VzZUVudGVyKGUpIHtcclxuICAgICAgICBpZiAodGhpcy5fbWVudS5faXNSZXZlYWxlZCkge1xyXG4gICAgICAgICAgICB0aGlzLl9tZW51LmxvY2tUYXJnZXRzKHRydWUpO1xyXG4gICAgICAgICAgICB0aGlzLnRvZ2dsZSh0cnVlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25Nb3VzZUxlYXZlKGUpIHtcclxuICAgICAgICBpZiAodGhpcy5fbWVudS5faXNSZXZlYWxlZCkge1xyXG4gICAgICAgICAgICB0aGlzLl9tZW51LmxvY2tUYXJnZXRzKGZhbHNlKTtcclxuICAgICAgICAgICAgdGhpcy50b2dnbGUoZmFsc2UpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXNldE1heEhlaWdodCgpIHtcclxuICAgICAgICB0aGlzLl9zdWJtZW51LmNzcygnbWF4LWhlaWdodCcsICcnKTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRNYXhIZWlnaHQoc3RhdGUpIHtcclxuICAgICAgICB0aGlzLl9zdWJtZW51LmNzcygnbWF4LWhlaWdodCcsIChzdGF0ZSkgPyB0aGlzLl9zdWJtZW51WzBdLnNjcm9sbEhlaWdodCA6IDApO1xyXG4gICAgfVxyXG5cclxuICAgIHRvZ2dsZShzdGF0ZSwgYW5pbWF0aW9uID0gdHJ1ZSkge1xyXG4gICAgICAgIHRoaXMuX3N1Ym1lbnUudG9nZ2xlQ2xhc3ModG9nZ2xlck5vQW5pbSwgIWFuaW1hdGlvbik7XHJcbiAgICAgICAgaWYgKHN0YXRlID09IHVuZGVmaW5lZCkgc3RhdGUgPSAhdGhpcy5fZXhwYW5kZWQ7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ3N1Ym1lbnUnLCB0aGlzLl9pbmRleCwgc3RhdGUsIHRoaXMuX2V4cGFuZGVkLCAoc3RhdGUgIT0gdGhpcy5fZXhwYW5kZWQpID8gJ3N0YXRlIGNoYW5nZWQnIDogJycpO1xyXG4gICAgICAgIGlmIChzdGF0ZSAhPSB0aGlzLl9leHBhbmRlZCkge1xyXG4gICAgICAgICAgICB0aGlzLl9idXR0b24udG9nZ2xlQ2xhc3ModG9nZ2xlckV4cGFuZGVkLCBzdGF0ZSk7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5fbWVudS5faXNSZXZlYWxlZCkgdGhpcy5zZXRNYXhIZWlnaHQoc3RhdGUpO1xyXG4gICAgICAgICAgICB0aGlzLl9zdWJtZW51LmF0dHIoYXR0ckFyaWFFeHBhbmRlZCwgc3RhdGUpO1xyXG4gICAgICAgICAgICB0aGlzLl9zdWJtZW51LnRvZ2dsZUNsYXNzKHRvZ2dsZXJDb2xsYXBzZWQsICFzdGF0ZSk7XHJcbiAgICAgICAgICAgIHRoaXMuX3N1Ym1lbnUudG9nZ2xlQ2xhc3ModG9nZ2xlckV4cGFuZGVkLCBzdGF0ZSk7XHJcbiAgICAgICAgICAgIHRoaXMuX2V4cGFuZGVkID0gc3RhdGU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG4vLyBJbml0aWFsaXplIGVsZW1lbnRzIHdpdGggJ2RhdGEtc2l0ZS1tZW51JyBhdHRyaWJ1dGVcclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG5sZXQgc2l0ZU1lbnVzID0gW107XHJcbiQoZG9jdW1lbnQpLnJlYWR5KCgpID0+IHtcclxuICAgICQoJ1snICsgYXR0clNpdGVNZW51ICsgJ10nKS5lYWNoKChpbmRleCwgaXRlbSkgPT4ge1xyXG4gICAgICAgIHNpdGVNZW51cy5wdXNoKG5ldyBTaXRlTWVudShpdGVtKSk7XHJcbiAgICB9KTtcclxufSk7Il19"}