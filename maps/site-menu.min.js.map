{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/js/site-menu.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","togglerExpanded","SiteMenu","element","_this","this","_classCallCheck","_menu","$","_button","attr","_multiExpand","_submenuAppendTo","_submenus","submenus","find","push","SubMenu","_locks","lockIds","stringToArray","_i","refresh","window","resize","onResize","state","toggleClass","isRevealed","is","_isRevealed","moveTo","resetMaxHeight","moveHome","setMaxHeight","toggle","animation","arguments","undefined","expectIndex","str","trim","indexOf","split","lenght","menu","index","_this2","_index","_submenu","_expanded","outerHeight","prev","_submenuIcon","appendTo","on","onClick","onMouseEnter","onMouseLeave","insertAfter","preventDefault","toggleSubmenus","lockTargets","css","scrollHeight","siteMenus","document","ready","each","item"],"mappings":"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","file":"../dist/site-menu.min.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","// SITE-MENU\r\n// =========\r\n\r\nconst attrAriaExpanded    = 'aria-expanded';\r\nconst attrMultiExpand     = 'data-multi-expand';\r\nconst attrSiteMenu        = 'data-site-menu';\r\nconst attrSiteMenuButton  = 'data-site-menu-button';\r\nconst attrSiteMenuLock    = 'data-site-menu-lock'\r\nconst attrSubmenuAppendTo = 'data-submenu-append-to';\r\nconst elSubmenuIcon       =  '<i class=\"submenu-icon\"></i>';\r\nconst togglerCollapsed    = 'is-collapsed';\r\nconst togglerExpanded     = 'is-expanded';\r\nconst togglerLocked       = 'is-locked';\r\nconst togglerNoAnim       = 'no-anim';\r\n\r\n// Menu\r\n// ----\r\n\r\nexport default class SiteMenu {\r\n    constructor(element) {\r\n        /* Initialize */\r\n        this._menu = $(element);\r\n        this._button = $('#' + this._menu.attr(attrSiteMenuButton));\r\n        this._multiExpand = (this._menu.attr(attrMultiExpand) == 'true');\r\n        this._submenuAppendTo = $('#' + this._menu.attr(attrSubmenuAppendTo));\r\n\r\n        /* Submenus */\r\n        this._submenus = [];\r\n        let submenus = this._menu.find('li>ul');\r\n        for (let i=0; i < submenus.length; i++) {\r\n            this._submenus.push(\r\n                new SubMenu(submenus[i], this, i)\r\n            );\r\n        }\r\n\r\n        /* Locks */\r\n        this._locks = []\r\n        let lockIds = SiteMenu.stringToArray(this._menu.attr(attrSiteMenuLock));\r\n        for (let i = 0; i < lockIds.length; i++) {\r\n            this._locks.push($('#' + lockIds[i]));\r\n        }\r\n\r\n        /* Refresh */\r\n        this.refresh();\r\n\r\n        /* Events */\r\n        $(window).resize((e) => { this.onResize(e) });\r\n    }\r\n\r\n    lockTargets(state) {\r\n        for (let i = 0; i < this._locks.length; i++) {\r\n            this._locks[i].toggleClass(togglerLocked, state)\r\n        }\r\n    }\r\n\r\n    onResize(e) {\r\n        this.refresh();\r\n    }\r\n\r\n    refresh() {\r\n        let isRevealed = !this._button.is(':visible');\r\n        if (isRevealed != this._isRevealed) { // State changed\r\n            this._isRevealed = isRevealed;\r\n            for (let i=0; i < this._submenus.length; i++) {\r\n                if (isRevealed) {\r\n                    this._submenus[i].moveTo(this._submenuAppendTo);\r\n                    this._submenus[i].resetMaxHeight(false);\r\n                } else {\r\n                    this._submenus[i].moveHome();\r\n                    this._submenus[i].setMaxHeight(false);\r\n                }\r\n                this._submenus[i].toggle(false, false);\r\n            }\r\n        }\r\n    }\r\n\r\n    static stringToArray(str) {\r\n        let a = [];\r\n        if (typeof str === 'string') {\r\n            str = str.trim();\r\n            if (str != '') {\r\n                a = (str.indexOf(',') > -1) ? str.split(/,/) : str.split(/ /);\r\n                for (let i=0; i < a.lenght; i++) a[i] = a[i].trim();\r\n            }\r\n        }\r\n        return a;\r\n    }\r\n\r\n    toggleSubmenus(state, animation = true, expectIndex) {\r\n        for (let i=0; i < this._submenus.length; i++) {\r\n            if (i != expectIndex) this._submenus[i].toggle(state, animation);\r\n        }\r\n    }\r\n}\r\n\r\n// SubMenu\r\n// -------\r\n\r\nclass SubMenu {\r\n    constructor(element, menu, index) {\r\n        this._index = index;\r\n        this._menu = menu;\r\n        this._submenu = $(element);\r\n        this._expanded = (this._submenu.outerHeight() > 0);\r\n        this._button = this._submenu.prev();\r\n        this._submenuIcon = $(elSubmenuIcon);\r\n        this._submenuIcon.appendTo(this._button);\r\n\r\n        this.toggle(this._expanded);\r\n\r\n        this._button.on('click', (e) => { this.onClick(e) });\r\n        this._button.on('mouseenter', (e) => { this.onMouseEnter(e) });\r\n        this._button.on('mouseleave', (e) => { this.onMouseLeave(e) });\r\n        this._submenu.on('mouseenter', (e) => { this.onMouseEnter(e) });\r\n        this._submenu.on('mouseleave', (e) => { this.onMouseLeave(e) });\r\n    }\r\n\r\n    moveHome() {\r\n        this._submenu.insertAfter(this._button);\r\n    }\r\n\r\n    moveTo(element) {\r\n        this._submenu.appendTo(element);\r\n    }\r\n\r\n    onClick(e) {\r\n        e.preventDefault();\r\n        if (this._menu._isRevealed) return;\r\n        if (!this._menu._multiExpand) this._menu.toggleSubmenus(false, true, this._index);\r\n        this.toggle();\r\n    }\r\n\r\n    onMouseEnter(e) {\r\n        if (this._menu._isRevealed) {\r\n            this._menu.lockTargets(true);\r\n            this.toggle(true);\r\n        }\r\n    }\r\n\r\n    onMouseLeave(e) {\r\n        if (this._menu._isRevealed) {\r\n            this._menu.lockTargets(false);\r\n            this.toggle(false);\r\n        }\r\n    }\r\n\r\n    resetMaxHeight() {\r\n        this._submenu.css('max-height', '');\r\n    }\r\n\r\n    setMaxHeight(state) {\r\n        this._submenu.css('max-height', (state) ? this._submenu[0].scrollHeight : 0);\r\n    }\r\n\r\n    toggle(state, animation = true) {\r\n        this._submenu.toggleClass(togglerNoAnim, !animation);\r\n        if (state == undefined) state = !this._expanded;\r\n        // console.log('submenu', this._index, state, this._expanded, (state != this._expanded) ? 'state changed' : '');\r\n        if (state != this._expanded) {\r\n            this._button.toggleClass(togglerExpanded, state);\r\n            if (!this._menu._isRevealed) this.setMaxHeight(state);\r\n            this._submenu.attr(attrAriaExpanded, state);\r\n            this._submenu.toggleClass(togglerCollapsed, !state);\r\n            this._submenu.toggleClass(togglerExpanded, state);\r\n            this._expanded = state;\r\n        }\r\n    }\r\n}\r\n\r\n// Initialize elements with 'data-site-menu' attribute\r\n// ---------------------------------------------------\r\n\r\nlet siteMenus = [];\r\n$(document).ready(() => {\r\n    $('[' + attrSiteMenu + ']').each((index, item) => {\r\n        siteMenus.push(new SiteMenu(item));\r\n    });\r\n});"]}